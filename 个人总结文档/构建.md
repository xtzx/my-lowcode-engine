
# LowCode Engine UMD 构建指南

## 📦 支持UMD构建的包

只有以下3个包支持UMD构建：
- `@alilc/lowcode-engine` (主引擎包)
- `@alilc/lowcode-react-renderer` (React渲染器)
- `@alilc/lowcode-react-simulator-renderer` (React模拟器渲染器)

## 🔧 构建方法

### 1. 构建主引擎包 (@alilc/lowcode-engine)

```bash
# 方法1: 直接在包目录下构建
cd packages/engine && npm run build:umd

# 方法2: 使用yarn workspace构建
yarn workspace @alilc/lowcode-engine run build:umd
```

配置在 packages/engine/build.plugin.js

**构建产物位于：**
```
packages/engine/dist/
├── css/engine-core.css     # 105KB 样式文件
└── js/
    ├── engine-core.js      # 1.09MB UMD主文件
    └── engine-core.js.map  # 2.71MB Source Map
```

### 2. 构建React渲染器 (@alilc/lowcode-react-renderer)

```bash
# 方法1: 直接在包目录下构建
cd packages/react-renderer && npm run build:umd

# 方法2: 使用yarn workspace构建
yarn workspace @alilc/lowcode-react-renderer run build:umd
```

**构建产物位于：**
```
packages/react-renderer/dist/
├── css/react-renderer.css        # 617B 样式文件
└── js/
    ├── react-renderer.js          # 347KB UMD主文件
    └── react-renderer.js.map      # 1.8MB Source Map
```

### 3. 构建React模拟器渲染器 (@alilc/lowcode-react-simulator-renderer)

```bash
# 方法1: 直接在包目录下构建
cd packages/react-simulator-renderer && npm run build:umd

# 方法2: 使用yarn workspace构建
yarn workspace @alilc/lowcode-react-simulator-renderer run build:umd
```

**构建产物位于：**
```
packages/react-simulator-renderer/dist/
├── css/react-simulator-renderer.css     # 2.4KB 样式文件
└── js/
    ├── react-simulator-renderer.js      # 452KB UMD主文件
    └── react-simulator-renderer.js.map  # 1.8MB Source Map
```

## 🚀 批量构建所有UMD包

```bash
# 在项目根目录执行，构建所有3个UMD包
npm run build:umd
```

## 📊 UMD包文件大小对比

| 包名 | JS文件 | CSS文件 | 说明 |
|------|---------|---------|------|
| engine | engine-core.js (1.09MB) | engine-core.css (105KB) | 主引擎包，包含设计器核心功能 |
| react-renderer | react-renderer.js (347KB) | react-renderer.css (617B) | React组件渲染器 |
| react-simulator-renderer | react-simulator-renderer.js (452KB) | react-simulator-renderer.css (2.4KB) | React模拟器渲染器 |

## 💡 使用建议

1. **开发调试**: 使用非压缩版本（已配置保留console.log）
2. **生产环境**: 根据需要选择对应的包
3. **按需加载**: 可以单独构建需要的包，无需全量构建

## 🔗 在业务项目中引用

```html
<!-- 引入主引擎 -->
<script src="path/to/engine-core.js"></script>
<link rel="stylesheet" href="path/to/engine-core.css">

<!-- 根据需要引入渲染器 -->
<script src="path/to/react-renderer.js"></script>
<link rel="stylesheet" href="path/to/react-renderer.css">

<script src="path/to/react-simulator-renderer.js"></script>
<link rel="stylesheet" href="path/to/react-simulator-renderer.css">
```
